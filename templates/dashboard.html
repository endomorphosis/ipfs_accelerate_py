<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPFS Accelerate MCP Server Dashboard</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <link rel="stylesheet" href="/static/css/github-workflows.css">
    <!-- Error Reporting -->
    <script src="/static/js/error-reporter.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ IPFS Accelerate MCP Server</h1>
            <p>Comprehensive AI Inference ‚Ä¢ Model Management ‚Ä¢ Performance Monitoring</p>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <div id="server-status" class="status-indicator online"></div>
                <div class="status-label">Server Status</div>
            </div>
            <div class="status-item">
                <div id="port-number" class="status-value">3001</div>
                <div class="status-label">Port</div>
            </div>
            <div class="status-item">
                <div id="active-connections" class="status-value">1</div>
                <div class="status-label">Active Connections</div>
            </div>
            <div class="status-item">
                <div id="uptime" class="status-value">6s</div>
                <div class="status-label">Uptime</div>
            </div>
            <div class="status-item">
                <div id="total-requests" class="status-value">3</div>
                <div class="status-label">Total Requests</div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview')">üè† Overview</button>
            <button class="nav-tab" onclick="showTab('ai-inference')">ü§ñ AI Inference</button>
            <button class="nav-tab" onclick="showTab('model-manager')">üìö Model Manager</button>
            <button class="nav-tab" onclick="showTab('queue-monitor')">üìä Queue Monitor</button>
            <button class="nav-tab" onclick="showTab('github-workflows')">‚ö° GitHub Workflows</button>
            <button class="nav-tab" onclick="showTab('mcp-tools')">üîß MCP Tools</button>
            <button class="nav-tab" onclick="showTab('coverage')">üéØ Coverage Analysis</button>
            <button class="nav-tab" onclick="showTab('system-logs')">üìù System Logs</button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>üîß MCP Server Status</h3>
                    <div class="info-row">
                        <span>Status:</span>
                        <span class="status-running">Running</span>
                    </div>
                    <div class="info-row">
                        <span>Transport:</span>
                        <span>HTTP + WebSocket</span>
                    </div>
                    <div class="info-row">
                        <span>Available Tools:</span>
                        <span>15</span>
                    </div>
                    <div class="info-row">
                        <span>API Version:</span>
                        <span>v1.0.0</span>
                    </div>
                    <button class="btn btn-primary" onclick="refreshStatus()">üîÑ Refresh Status</button>
                </div>

                <div class="card">
                    <h3>ü§ñ AI Capabilities</h3>
                    <div class="capability-item">
                        <span>Text Processing:</span>
                        <span class="badge badge-active">Active</span>
                    </div>
                    <div class="capability-item">
                        <span>Audio Processing:</span>
                        <span class="badge badge-active">Active</span>
                    </div>
                    <div class="capability-item">
                        <span>Vision Processing:</span>
                        <span class="badge badge-active">Active</span>
                    </div>
                    <div class="capability-item">
                        <span>Multimodal:</span>
                        <span class="badge badge-active">Active</span>
                    </div>
                    <button class="btn btn-success" onclick="showTab('ai-inference')">‚ö° Test Inference</button>
                </div>

                <div class="card">
                    <h3>üìö Model Information</h3>
                    <div class="info-row">
                        <span>Loaded Models:</span>
                        <span id="loaded-models-count">0</span>
                    </div>
                    <div class="info-row">
                        <span>Available Models:</span>
                        <span id="available-models-count">0</span>
                    </div>
                    <div class="info-row">
                        <span>Storage Backend:</span>
                        <span>JSON + Vector Index</span>
                    </div>
                    <div class="info-row">
                        <span>Cache Status:</span>
                        <span class="badge badge-enabled">Enabled</span>
                    </div>
                    <button class="btn btn-info" onclick="showTab('model-manager')">üìñ View Models</button>
                </div>

                <div class="card">
                    <h3>üìä Performance Metrics</h3>
                    <div class="info-row">
                        <span>CPU Usage:</span>
                        <span>17%</span>
                    </div>
                    <div class="info-row">
                        <span>Memory Usage:</span>
                        <span>26%</span>
                    </div>
                    <div class="info-row">
                        <span>Queue Length:</span>
                        <span>0</span>
                    </div>
                    <div class="info-row">
                        <span>Avg Response Time:</span>
                        <span>584ms</span>
                    </div>
                    <button class="btn btn-secondary" onclick="refreshMetrics()">üìà Refresh Metrics</button>
                </div>
            </div>
        </div>

        <!-- AI Inference Tab -->
        <div id="ai-inference" class="tab-content">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>ü§ñ AI Inference Testing</h3>
                    <div class="form-group">
                        <label for="inference-type">Inference Type:</label>
                        <select id="inference-type" onchange="updateInferenceForm()">
                            <option value="text-generation">Text Generation</option>
                            <option value="text-classification">Text Classification</option>
                            <option value="text-embeddings">Text Embeddings</option>
                            <option value="translation">Translation</option>
                            <option value="summarization">Summarization</option>
                            <option value="question-answering">Question Answering</option>
                            <option value="audio-transcription">Audio Transcription</option>
                            <option value="audio-classification">Audio Classification</option>
                            <option value="speech-synthesis">Speech Synthesis (TTS)</option>
                            <option value="audio-generation">Audio Generation</option>
                            <option value="image-classification">Image Classification</option>
                            <option value="object-detection">Object Detection</option>
                            <option value="image-segmentation">Image Segmentation</option>
                            <option value="image-generation">Image Generation</option>
                            <option value="image-captioning">Image Captioning</option>
                            <option value="visual-qa">Visual Q&A</option>
                            <option value="document-processing">Document Processing</option>
                            <option value="code-generation">Code Generation</option>
                            <option value="time-series">Time Series Forecasting</option>
                            <option value="tabular-data">Tabular Data Processing</option>
                        </select>
                    </div>
                    
                    <div id="inference-form">
                        <!-- Dynamic form will be populated here -->
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-success" onclick="runInference()">‚ö° Run Inference</button>
                        <button class="btn btn-secondary" onclick="clearInferenceForm()">üßπ Clear</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üéØ Inference Results</h3>
                    <div id="inference-results">
                        <p>Ready to run inference...</p>
                        <p>Try these examples:</p>
                        <ul>
                            <li>Text: "Explain quantum computing"</li>
                            <li>Classification: "This product is amazing!"</li>
                            <li>Translation: "Hello world" ‚Üí Spanish</li>
                            <li>Summarization: Long article text</li>
                        </ul>
                    </div>
                    <div class="result-metadata">
                        <div class="info-row">
                            <span>Execution Time:</span>
                            <span id="execution-time">-</span>
                        </div>
                        <div class="info-row">
                            <span>Model Used:</span>
                            <span id="model-used">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Model Manager Tab -->
        <div id="model-manager" class="tab-content">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>ü§ó HuggingFace Model Search</h3>
                    <div class="form-group">
                        <label for="hf-search">Search HuggingFace Hub:</label>
                        <input type="text" id="hf-search" placeholder="Enter model name (e.g., llama, bert, gpt)" />
                    </div>
                    <div class="form-group">
                        <label for="task-filter">Filter by Task:</label>
                        <select id="task-filter">
                            <option value="">All Tasks</option>
                            <option value="text-generation">Text Generation</option>
                            <option value="text-classification">Text Classification</option>
                            <option value="question-answering">Question Answering</option>
                            <option value="text2text-generation">Text-to-Text Generation</option>
                            <option value="automatic-speech-recognition">Speech Recognition</option>
                            <option value="text-to-speech">Text-to-Speech</option>
                            <option value="image-classification">Image Classification</option>
                            <option value="object-detection">Object Detection</option>
                            <option value="image-segmentation">Image Segmentation</option>
                            <option value="text-to-image">Text-to-Image</option>
                            <option value="image-to-text">Image-to-Text</option>
                            <option value="code-generation">Code Generation</option>
                            <option value="time-series-forecasting">Time Series Forecasting</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="size-filter">Model Size Filter:</label>
                        <select id="size-filter">
                            <option value="">All Sizes</option>
                            <option value="tiny">Tiny (< 100M params)</option>
                            <option value="small">Small (100M - 1B params)</option>
                            <option value="medium">Medium (1B - 10B params)</option>
                            <option value="large">Large (10B+ params)</option>
                        </select>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="searchHuggingFace()">üîç Search HF Hub</button>
                        <button class="btn btn-secondary" onclick="clearHFResults()">üóëÔ∏è Clear Results</button>
                    </div>
                    <div id="hf-search-results">
                        <!-- Search results will appear here -->
                    </div>
                </div>

                <div class="card">
                    <h3>üîß Hardware Compatibility Testing</h3>
                    <div class="form-group">
                        <label for="test-model-id">Model ID:</label>
                        <input type="text" id="test-model-id" placeholder="Enter model ID or select from search results" />
                    </div>
                    <div class="form-group">
                        <label>Hardware Platforms to Test:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" value="cpu" checked> CPU</label>
                            <label><input type="checkbox" value="cuda"> CUDA (NVIDIA)</label>
                            <label><input type="checkbox" value="rocm"> ROCm (AMD)</label>
                            <label><input type="checkbox" value="openvino"> OpenVINO (Intel)</label>
                            <label><input type="checkbox" value="mps"> MPS (Apple Silicon)</label>
                            <label><input type="checkbox" value="webgpu"> WebGPU</label>
                            <label><input type="checkbox" value="directml"> DirectML</label>
                            <label><input type="checkbox" value="onnx"> ONNX Runtime</label>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="batch-size">Batch Size:</label>
                            <input type="number" id="batch-size" value="1" min="1" max="32" />
                        </div>
                        <div class="form-group">
                            <label for="seq-length">Sequence Length:</label>
                            <input type="number" id="seq-length" value="512" min="64" max="2048" />
                        </div>
                        <div class="form-group">
                            <label for="precision">Precision:</label>
                            <select id="precision">
                                <option value="FP32">FP32</option>
                                <option value="FP16">FP16</option>
                                <option value="INT8">INT8</option>
                                <option value="INT4">INT4</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn btn-success" onclick="testModelCompatibility()">üß™ Test Compatibility</button>
                    <div id="compatibility-results">
                        <!-- Test results will appear here -->
                    </div>
                </div>

                <div class="card">
                    <h3>üìä Model Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="total-indexed-models">0</div>
                            <div class="stat-label">Total Indexed Models</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="hf-models-count">0</div>
                            <div class="stat-label">HuggingFace Models</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="compatible-models">0</div>
                            <div class="stat-label">Compatible Models</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="tested-models">0</div>
                            <div class="stat-label">Tested Models</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Coverage Analysis Tab -->
        <div id="coverage" class="tab-content">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>üéØ Model-Hardware Coverage Analysis</h3>
                    <div id="coverage-matrix">
                        <!-- Coverage matrix will be populated here -->
                    </div>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="refreshCoverageMatrix()">üîÑ Refresh Matrix</button>
                        <button class="btn btn-success" onclick="testMissingPlatforms()">‚ö° Test Missing Platforms</button>
                        <button class="btn btn-warning" onclick="autoFillCriticalGaps()">üéØ Auto-Fill Critical Gaps</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üíæ Parquet Data Management</h3>
                    <div class="info-row">
                        <span>Current Data File:</span>
                        <span id="current-parquet-file">benchmark_results_2024-01-15.parquet</span>
                    </div>
                    <div class="info-row">
                        <span>Total Records:</span>
                        <span id="total-records">247</span>
                    </div>
                    <div class="info-row">
                        <span>File Size:</span>
                        <span id="file-size">2.1 MB</span>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-info" onclick="exportParquetData()">üìä Export Data</button>
                        <button class="btn btn-secondary" onclick="backupParquetData()">üíæ Backup Data</button>
                        <button class="btn btn-warning" onclick="analyzeTrends()">üìà Analyze Trends</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üìà Coverage Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value">247</div>
                            <div class="stat-label">Total Models Tested</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">8</div>
                            <div class="stat-label">Hardware Platforms</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">73%</div>
                            <div class="stat-label">Coverage Percentage</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="last-test-date">2024-01-15</div>
                            <div class="stat-label">Last Test Date</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Queue Monitor Tab -->
        <div id="queue-monitor" class="tab-content">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>üìä Queue Status</h3>
                    <div class="info-row">
                        <span>Pending Jobs:</span>
                        <span id="pending-jobs">0</span>
                    </div>
                    <div class="info-row">
                        <span>Running Jobs:</span>
                        <span id="running-jobs">0</span>
                    </div>
                    <div class="info-row">
                        <span>Completed Jobs:</span>
                        <span id="completed-jobs">0</span>
                    </div>
                    <div class="info-row">
                        <span>Failed Jobs:</span>
                        <span id="failed-jobs">0</span>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="refreshQueue()">üîÑ Refresh Queue</button>
                        <button class="btn btn-warning" onclick="clearQueue()">üóëÔ∏è Clear Queue</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üë∑ Worker Management</h3>
                    <div class="info-row">
                        <span>Active Workers:</span>
                        <span id="active-workers">1</span>
                    </div>
                    <div class="info-row">
                        <span>Worker Pool Size:</span>
                        <span id="worker-pool-size">4</span>
                    </div>
                    <div class="info-row">
                        <span>Average Job Time:</span>
                        <span id="avg-job-time">-</span>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-success" onclick="addWorker()">‚ûï Add Worker</button>
                        <button class="btn btn-danger" onclick="removeWorker()">‚ûñ Remove Worker</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üìà Queue Analytics</h3>
                    <div class="info-row">
                        <span>Jobs/Hour:</span>
                        <span id="jobs-per-hour">0</span>
                    </div>
                    <div class="info-row">
                        <span>Success Rate:</span>
                        <span id="success-rate">100%</span>
                    </div>
                    <div class="info-row">
                        <span>Peak Queue Size:</span>
                        <span id="peak-queue-size">0</span>
                    </div>
                    <button class="btn btn-info" onclick="exportQueueStats()">üìä Export Stats</button>
                </div>
            </div>
        </div>

        <!-- MCP Tools Tab -->
        <div id="mcp-tools" class="tab-content">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>üîß Available MCP Tools</h3>
                    <div class="tools-grid">
                        <div class="tool-tag">text_generation</div>
                        <div class="tool-tag">text_classification</div>
                        <div class="tool-tag">text_embeddings</div>
                        <div class="tool-tag">audio_transcription</div>
                        <div class="tool-tag">image_classification</div>
                        <div class="tool-tag">visual_qa</div>
                        <div class="tool-tag">model_search</div>
                        <div class="tool-tag">model_recommend</div>
                        <div class="tool-tag">queue_status</div>
                        <div class="tool-tag">performance_stats</div>
                    </div>
                    <button class="btn btn-primary" onclick="refreshTools()">üîÑ Refresh Tools</button>
                </div>

                <div class="card">
                    <h3>üîå API Endpoints</h3>
                    <div class="endpoint-list">
                        <div class="endpoint-item">
                            <span class="method">GET</span>
                            <span class="path">/api/mcp/*</span>
                            <span class="desc">MCP Server</span>
                        </div>
                        <div class="endpoint-item">
                            <span class="method">POST</span>
                            <span class="path">/api/models/search</span>
                            <span class="desc">Model Search</span>
                        </div>
                        <div class="endpoint-item">
                            <span class="method">POST</span>
                            <span class="path">/api/models/test</span>
                            <span class="desc">Hardware Testing</span>
                        </div>
                        <div class="endpoint-item">
                            <span class="method">GET</span>
                            <span class="path">/api/queue/*</span>
                            <span class="desc">Queue API</span>
                        </div>
                        <div class="endpoint-item">
                            <span class="method">POST</span>
                            <span class="path">/api/inference/*</span>
                            <span class="desc">Inference API</span>
                        </div>
                    </div>
                    <button class="btn btn-success" onclick="testAPIs()">‚ö° Test APIs</button>
                </div>

                <div class="card">
                    <h3>‚öôÔ∏è Server Configuration</h3>
                    <div class="info-row">
                        <span>Max Queue Size:</span>
                        <span>1000</span>
                    </div>
                    <div class="info-row">
                        <span>Request Timeout:</span>
                        <span>30s</span>
                    </div>
                    <div class="info-row">
                        <span>Cache TTL:</span>
                        <span>3600s</span>
                    </div>
                    <div class="info-row">
                        <span>Log Level:</span>
                        <span>INFO</span>
                    </div>
                    <button class="btn btn-warning" onclick="editConfig()">‚öôÔ∏è Edit Config</button>
                </div>
            </div>
        </div>

        <!-- GitHub Workflows Tab -->
        <div id="github-workflows" class="tab-content">
            <div class="dashboard-grid">
                <div class="card">
                    <h3>üìä GitHub API Cache Statistics</h3>
                    <div id="github-cache-stats">
                        <p class="loading-message">Loading cache statistics...</p>
                    </div>
                    <div class="button-group" style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="githubManager?.fetchCacheStats()">üîÑ Refresh</button>
                        <button class="btn btn-warning" onclick="githubManager?.invalidateCache()">üóëÔ∏è Clear All Cache</button>
                        <button class="btn btn-secondary" onclick="githubManager?.invalidateCache('workflow')">Clear Workflow Cache</button>
                    </div>
                </div>

                <div class="card">
                    <h3>‚ö° GitHub API Rate Limit</h3>
                    <div id="github-rate-limit">
                        <p class="loading-message">Loading rate limit information...</p>
                    </div>
                    <div class="button-group" style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="githubManager?.fetchRateLimit()">üîÑ Refresh</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üìä Workflow Queue Overview</h3>
                    <div id="github-stats-overview">
                        <p class="loading-message">Loading workflow statistics...</p>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <h3>‚öôÔ∏è Active Workflows</h3>
                    <div id="github-workflows-container">
                        <p class="loading-message">Loading workflows...</p>
                    </div>
                    <div class="button-group" style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="githubManager?.fetchWorkflows()">üîÑ Refresh Workflows</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üñ•Ô∏è Self-Hosted Runners</h3>
                    <div id="github-runners-container">
                        <p class="loading-message">Loading runners...</p>
                    </div>
                    <div class="button-group" style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="githubManager?.fetchRunners()">üîÑ Refresh Runners</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Logs Tab -->
        <div id="system-logs" class="tab-content">
            <div class="card">
                <h3>üìù System Logs</h3>
                <div class="log-controls">
                    <button class="btn btn-primary" onclick="refreshLogs()">üîÑ Refresh</button>
                    <button class="btn btn-secondary" onclick="clearLogs()">üßπ Clear</button>
                    <button class="btn btn-info" onclick="downloadLogs()">üíæ Download</button>
                </div>
                <div id="log-container" class="log-container">
                    <div class="log-entry">
                        <span class="log-timestamp">2024-01-15 10:30:15</span>
                        <span class="log-level log-info">INFO</span>
                        <span class="log-message">MCP Server started successfully on port 3001</span>
                    </div>
                    <div class="log-entry">
                        <span class="log-timestamp">2024-01-15 10:30:16</span>
                        <span class="log-level log-info">INFO</span>
                        <span class="log-message">Dashboard interface available at http://localhost:3001</span>
                    </div>
                    <div class="log-entry">
                        <span class="log-timestamp">2024-01-15 10:30:20</span>
                        <span class="log-level log-info">INFO</span>
                        <span class="log-message">WebSocket connection established</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MCP SDK and GitHub Workflows Integration -->
    <script src="/static/js/mcp-sdk.js"></script>
    <script src="/static/js/github-workflows.js"></script>
    <script src="/static/js/dashboard.js"></script>
    
    <!-- Initialize Error Reporting -->
    <script>
        // Initialize error reporting when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Install global error handlers
                installGlobalErrorHandler('dashboard');
                console.log('‚úì Error reporting initialized for dashboard');
            } catch (error) {
                console.warn('Failed to initialize error reporting:', error);
            }
        });
    </script>
</body>
</html>