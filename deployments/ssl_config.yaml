#!/usr/bin/env yaml
# Enterprise SSL/TLS Configuration for IPFS Accelerate Python
# Complete security configuration with enterprise-grade encryption

version: '3.8'

ssl_configuration:
  # SSL/TLS Settings
  enabled: true
  tls_version: "1.3"
  cipher_suites:
    - TLS_AES_256_GCM_SHA384
    - TLS_AES_128_GCM_SHA256
    - TLS_CHACHA20_POLY1305_SHA256
    - ECDHE-RSA-AES256-GCM-SHA384
    - ECDHE-RSA-AES128-GCM-SHA256
  
  # Certificate Configuration
  certificates:
    # Production certificate paths
    production:
      cert_path: "/etc/ssl/certs/ipfs-accelerate.crt"
      key_path: "/etc/ssl/private/ipfs-accelerate.key"
      ca_path: "/etc/ssl/certs/ca-certificates.crt"
      
    # Development self-signed certificates  
    development:
      cert_path: "./certs/dev-cert.pem"
      key_path: "./certs/dev-key.pem"
      generate_self_signed: true
      
    # Staging environment
    staging:
      cert_path: "/etc/letsencrypt/live/staging.ipfs-accelerate.com/fullchain.pem"
      key_path: "/etc/letsencrypt/live/staging.ipfs-accelerate.com/privkey.pem"
      auto_renew: true

  # Advanced Security Settings
  security:
    hsts_enabled: true
    hsts_max_age: 31536000  # 1 year
    hsts_include_subdomains: true
    hsts_preload: true
    
    # Content Security Policy
    csp_enabled: true
    csp_policy: "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' wss: https:"
    
    # Additional headers
    x_frame_options: "DENY"
    x_content_type_options: "nosniff"
    x_xss_protection: "1; mode=block"
    referrer_policy: "strict-origin-when-cross-origin"

  # Certificate Management
  certificate_management:
    auto_renewal: true
    renewal_days_before_expiry: 30
    backup_certificates: true
    certificate_monitoring: true
    
    # Let's Encrypt configuration
    letsencrypt:
      enabled: true
      email: "admin@ipfs-accelerate.com"
      staging: false  # Use production ACME server
      webroot_path: "/var/www/certbot"
    
    # Certificate validation
    validation:
      check_expiry: true
      check_chain: true  
      check_revocation: true
      alert_on_issues: true

  # Load Balancer SSL Termination
  load_balancer:
    ssl_termination: "loadbalancer"  # Options: loadbalancer, backend, passthrough
    backend_encryption: true
    session_affinity: "cookie"
    
  # Kubernetes TLS Configuration
  kubernetes:
    ingress_tls: true
    cert_manager: true
    cluster_issuer: "letsencrypt-prod"
    tls_secret_name: "ipfs-accelerate-tls"
    
  # Cloud Provider SSL Integration
  cloud_ssl:
    aws:
      certificate_arn: "arn:aws:acm:us-east-1:123456789012:certificate/abcd1234-efgh-5678-ijkl-9012mnopqrst"
      cloudfront_ssl: true
      alb_ssl_policy: "ELBSecurityPolicy-TLS-1-2-2017-01"
      
    azure:
      key_vault_certificate: "ipfs-accelerate-cert"
      application_gateway_ssl: true
      
    gcp:
      ssl_certificate_name: "ipfs-accelerate-ssl-cert"
      cloud_load_balancer_ssl: true

# Enterprise Security Compliance
compliance:
  # PCI DSS Requirements
  pci_dss:
    encrypt_cardholder_data: true
    secure_transmission: true
    key_management: true
    
  # SOC 2 Requirements  
  soc2:
    data_encryption: true
    access_controls: true
    monitoring: true
    
  # GDPR Requirements
  gdpr:
    data_protection: true
    encryption_required: true
    consent_management: true
    
  # HIPAA Requirements
  hipaa:
    data_encryption: true
    access_logging: true
    secure_transmission: true

# Monitoring and Alerting for SSL
monitoring:
  ssl_monitoring:
    certificate_expiry_alerts: true
    ssl_handshake_monitoring: true
    cipher_suite_validation: true
    
  metrics:
    - ssl_certificate_expiry_days
    - ssl_handshake_duration_ms  
    - ssl_errors_total
    - tls_version_usage
    
  alerts:
    certificate_expiry_warning: 30  # days
    certificate_expiry_critical: 7   # days
    ssl_error_rate_threshold: 0.01  # 1%

# Automated SSL Setup Scripts
automation:
  setup_script: "./scripts/setup_ssl.sh"
  renewal_script: "./scripts/renew_ssl.sh"
  validation_script: "./scripts/validate_ssl.sh"
  rollback_script: "./scripts/rollback_ssl.sh"